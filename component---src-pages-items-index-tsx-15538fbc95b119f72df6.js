"use strict";(self.webpackChunkslap_kommerce_web=self.webpackChunkslap_kommerce_web||[]).push([[62],{473:function(e,t,n){n.d(t,{Cg:function(){return l},FG:function(){return c},Jc:function(){return i},Q3:function(){return m},QA:function(){return o},Wl:function(){return s},ZE:function(){return p},fj:function(){return a},sm:function(){return u}});var r=n(5937);async function l(){const{data:e,error:t}=await r.N.from("price_items").select("uid, name, sku, bulk, carton");return t?(console.error("Error fetching price items:",t.message),[]):e.map(e=>({uid:e.uid,item:e.name,sku:e.sku,bulk:parseFloat(e.bulk),carton:parseInt(e.carton),qty:1,sell:0}))}async function a(){const{data:e,error:t}=await r.N.from("supply_list_meta").select("list_name").order("list_name",{ascending:!0});return t?(console.error("Error fetching list names from meta:",t.message),[]):e.map(e=>e.list_name)}async function s(e){const{data:t,error:n}=await r.N.from("supply_list").select("\n      quantity,\n      sell,\n      item:price_items (\n        uid,\n        name,\n        sku,\n        bulk,\n        carton\n      )\n    ").eq("list_name",e);if(n)return console.error("Error fetching supply list details:",n.message),{items:[],meta:null};const l=(t||[]).map(e=>{var t,n;const r=parseFloat(e.item.bulk)/e.item.carton,l=parseFloat(null!==(t=e.sell)&&void 0!==t?t:0),a=null!==(n=e.quantity)&&void 0!==n?n:1,s=(l-r)*a;return{uid:e.item.uid,item:e.item.name,sku:e.item.sku,bulk:parseFloat(e.item.bulk),carton:e.item.carton,costEa:r,qty:a,sell:l,profit:s}}),{data:a,error:s}=await r.N.from("supply_list_meta").select("margin, shipping_rate").eq("list_name",e).limit(1).single();return s&&console.error("Error fetching supply list meta:",s.message),{items:l,meta:a||null}}async function i(e,t,n){void 0===n&&(n=!1);const l=(t||[]).filter(e=>e.uid&&"number"==typeof e.qty&&"number"==typeof e.sell).map(t=>({list_name:e,item_uid:t.uid,quantity:t.qty>0?t.qty:1,sell:isNaN(t.sell)?0:parseFloat(t.sell)}));if(0===l.length)return console.warn("⚠️ No valid items to upsert."),!1;const{error:a}=n?await r.N.from("supply_list").upsert(l,{onConflict:["list_name","item_uid"]}):await r.N.from("supply_list").insert(l);return!a||(console.error(`❌ Error ${n?"upserting":"inserting"} supply list items:`,a.message),!1)}async function o(e,t,n){if(void 0===n&&(n=!0),!t.length)return console.warn("⚠️ No valid items to upsert."),!1;const{error:l}=await r.N.from("supply_list").upsert(t,{onConflict:["list_name","item_uid"]});return!l||(console.error("❌ Supabase upsert error:",l.message),!1)}async function u(e,t,n){const{error:l}=await r.N.from("supply_list_meta").upsert([{list_name:e,margin:t,shipping_rate:n}],{onConflict:["list_name"]});return!l||(console.error("❌ Supabase error saving supply_list_meta:",l.message),!1)}async function m(e){const{data:t,error:n}=await r.N.from("supply_list_meta").select("list_name").eq("list_name",e).limit(1);return n?(console.error("Error checking list name:",n.message),!1):!!(t&&t.length>0)}async function c(e){const{data:t,error:n}=await r.N.from("supply_list_meta").select("margin, shipping_rate").eq("list_name",e).limit(1).single();return n?(console.error("Error fetching supply list meta:",n.message),null):t}async function p(e){const{error:t}=await r.N.from("supply_list").delete().eq("list_name",e),{error:n}=await r.N.from("supply_list_meta").delete().eq("list_name",e);return!t&&!n||(console.error("❌ Failed to delete list:",(null==t?void 0:t.message)||(null==n?void 0:n.message)),!1)}},7058:function(e,t,n){n.r(t),n.d(t,{default:function(){return s}});var r=n(4506),l=n(6540),a=n(473);function s(){const{0:e,1:t}=(0,l.useState)([]),{0:n,1:s}=(0,l.useState)(!0);(0,l.useEffect)(()=>{(0,a.Cg)().then(e=>{t(e),s(!1)})},[]);const i=(n,l,a)=>{const s=(0,r.A)(e);s[n][l]="item"===l||"sku"===l||"uid"===l?a:parseFloat(a)||0,t(s)};return l.createElement("div",{style:{padding:20,fontFamily:"Arial"}},l.createElement("h2",null,"Item List from Supabase"),n?l.createElement("p",null,"Loading..."):l.createElement("table",{border:1,cellPadding:6,cellSpacing:0},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",null,"Item"),l.createElement("th",null,"SKU"),l.createElement("th",null,"Bulk"),l.createElement("th",null,"Carton"),l.createElement("th",null,"Cost Ea."))),l.createElement("tbody",null,e.map((e,t)=>{const n=e.carton>0?e.bulk/e.carton:0;return l.createElement("tr",{key:e.uid},l.createElement("td",null,l.createElement("input",{value:e.item,onChange:e=>i(t,"item",e.target.value)})),l.createElement("td",null,l.createElement("input",{value:e.sku,onChange:e=>i(t,"sku",e.target.value)})),l.createElement("td",null,l.createElement("input",{type:"number",value:e.bulk,onChange:e=>i(t,"bulk",e.target.value)})),l.createElement("td",null,l.createElement("input",{type:"number",value:e.carton,onChange:e=>i(t,"carton",e.target.value)})),l.createElement("td",null,"$",n.toFixed(2)))}))))}}}]);
//# sourceMappingURL=component---src-pages-items-index-tsx-15538fbc95b119f72df6.js.map