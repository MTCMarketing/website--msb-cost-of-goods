{"version":3,"file":"component---src-pages-items-index-tsx-15538fbc95b119f72df6.js","mappings":"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","sources":["webpack://slap-kommerce-web/./src/tables/tables.ts","webpack://slap-kommerce-web/./src/pages/items/index.tsx"],"sourcesContent":["import { supabase } from '../supabase';\n\nexport async function fetchPriceItems() {\n  const { data, error } = await supabase\n    .from('price_items')\n    .select('uid, name, sku, bulk, carton');\n\n  if (error) {\n    console.error('Error fetching price items:', error.message);\n    return [];\n  }\n\n  return data.map(item => ({\n    uid: item.uid,\n    item: item.name,\n    sku: item.sku,\n    bulk: parseFloat(item.bulk),\n    carton: parseInt(item.carton),\n    qty: 1,\n    sell: 0\n  }));\n}\n\nexport async function fetchSupplyLists(): Promise<string[]> {\n  const { data, error } = await supabase\n    .from('supply_list_meta')\n    .select('list_name')\n    .order('list_name', { ascending: true });\n\n  if (error) {\n    console.error('Error fetching list names from meta:', error.message);\n    return [];\n  }\n\n  return data.map(row => row.list_name);\n}\n\n\n\nexport async function fetchSupplyListDetails(listName: string) {\n  const { data, error } = await supabase\n    .from('supply_list')\n    .select(`\n      quantity,\n      sell,\n      item:price_items (\n        uid,\n        name,\n        sku,\n        bulk,\n        carton\n      )\n    `)\n    .eq('list_name', listName);\n\n  if (error) {\n    console.error('Error fetching supply list details:', error.message);\n    return { items: [], meta: null };\n  }\n\n  const items = (data || []).map(row => {\n    const costEa = parseFloat(row.item.bulk) / row.item.carton;\n    const sell = parseFloat(row.sell ?? 0);\n    const qty = row.quantity ?? 1;\n    const profit = (sell - costEa) * qty;\n\n    return {\n      uid: row.item.uid,\n      item: row.item.name,\n      sku: row.item.sku,\n      bulk: parseFloat(row.item.bulk),\n      carton: row.item.carton,\n      costEa,\n      qty,                 // ✅ Important: use 'qty' not 'quantity'\n      sell,\n      profit\n    };\n  });\n\n  const { data: metaData, error: metaError } = await supabase\n    .from('supply_list_meta')\n    .select('margin, shipping_rate')\n    .eq('list_name', listName)\n    .limit(1)\n    .single();\n\n  if (metaError) {\n    console.error('Error fetching supply list meta:', metaError.message);\n  }\n\n  return {\n    items,\n    meta: metaData || null\n  };\n}\n\n\nexport async function saveSupplyListItems(listName: string, items: any[], upsert = false) {\n  // Convert to valid rows with required fields\n  const rows = (items || [])\n    .filter(i => i.uid && typeof i.qty === 'number' && typeof i.sell === 'number')\n    .map(i => ({\n      list_name: listName,\n      item_uid: i.uid, // ✅ match schema field\n      quantity: i.qty > 0 ? i.qty : 1,\n      sell: isNaN(i.sell) ? 0 : parseFloat(i.sell)\n    }));\n\n  if (rows.length === 0) {\n    console.warn('⚠️ No valid items to upsert.');\n    return false;\n  }\n\n  const { error } = upsert\n    ? await supabase\n        .from('supply_list')\n        .upsert(rows, { onConflict: ['list_name', 'item_uid'] })\n    : await supabase\n        .from('supply_list')\n        .insert(rows);\n\n  if (error) {\n    console.error(`❌ Error ${upsert ? 'upserting' : 'inserting'} supply list items:`, error.message);\n    return false;\n  }\n\n  return true;\n}\n\n\n\n\n\nexport async function editSupplyListItems(listName: string, items: any[], overwrite = true) {\n  if (!items.length) {\n    console.warn('⚠️ No valid items to upsert.');\n    return false;\n  }\n\n  const { error } = await supabase\n    .from('supply_list')\n    .upsert(items, { onConflict: ['list_name', 'item_uid'] });\n\n  if (error) {\n    console.error('❌ Supabase upsert error:', error.message);\n    return false;\n  }\n\n  return true;\n}\n\n\nexport async function saveSupplyListMeta(listName: string, margin: number, shipping: number) {\n  const { error } = await supabase\n    .from('supply_list_meta')\n    .upsert(\n      [{ list_name: listName, margin, shipping_rate: shipping }],\n      { onConflict: ['list_name'] }\n    );\n\n  if (error) {\n    console.error('❌ Supabase error saving supply_list_meta:', error.message);\n    return false;\n  }\n\n  return true;\n}\n\nexport async function checkListNameExists(listName: string): Promise<boolean> {\n  const { data, error } = await supabase\n    .from('supply_list_meta')\n    .select('list_name')\n    .eq('list_name', listName)\n    .limit(1);\n\n  if (error) {\n    console.error('Error checking list name:', error.message);\n    return false;\n  }\n\n  return !!(data && data.length > 0);\n}\n\nexport async function fetchSupplyListMeta(listName: string) {\n  const { data, error } = await supabase\n    .from('supply_list_meta')\n    .select('margin, shipping_rate')\n    .eq('list_name', listName)\n    .limit(1)\n    .single();\n\n  if (error) {\n    console.error('Error fetching supply list meta:', error.message);\n    return null;\n  }\n\n  return data;\n}\n\nexport async function deleteSupplyList(listName: string) {\n  const { error: itemError } = await supabase\n    .from('supply_list')\n    .delete()\n    .eq('list_name', listName);\n\n  const { error: metaError } = await supabase\n    .from('supply_list_meta')\n    .delete()\n    .eq('list_name', listName);\n\n  if (itemError || metaError) {\n    console.error('❌ Failed to delete list:', itemError?.message || metaError?.message);\n    return false;\n  }\n\n  return true;\n}\n","import React, { useEffect, useState } from 'react';\nimport { fetchPriceItems } from '../../tables/tables';\n\nexport default function Items() {\n  const [items, setItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchPriceItems().then(data => {\n      setItems(data);\n      setLoading(false);\n    });\n  }, []);\n\n  const updateItem = (index, field, value) => {\n    const updated = [...items];\n    updated[index][field] = field === 'item' || field === 'sku' || field === 'uid'\n      ? value\n      : parseFloat(value) || 0;\n    setItems(updated);\n  };\n\n  return (\n    <div style={{ padding: 20, fontFamily: 'Arial' }}>\n      <h2>Item List from Supabase</h2>\n      {loading ? (\n        <p>Loading...</p>\n      ) : (\n        <table border={1} cellPadding={6} cellSpacing={0}>\n          <thead>\n            <tr>\n              <th>Item</th>\n              <th>SKU</th>\n              <th>Bulk</th>\n              <th>Carton</th>\n              <th>Cost Ea.</th>\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((row, idx) => {\n              const costEa = row.carton > 0 ? row.bulk / row.carton : 0;\n              return (\n                <tr key={row.uid}>\n                  <td><input value={row.item} onChange={e => updateItem(idx, 'item', e.target.value)} /></td>\n                  <td><input value={row.sku} onChange={e => updateItem(idx, 'sku', e.target.value)} /></td>\n                  <td><input type=\"number\" value={row.bulk} onChange={e => updateItem(idx, 'bulk', e.target.value)} /></td>\n                  <td><input type=\"number\" value={row.carton} onChange={e => updateItem(idx, 'carton', e.target.value)} /></td>\n                  <td>${costEa.toFixed(2)}</td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      )}\n    </div>\n  );\n}\n"],"names":["async","fetchPriceItems","data","error","supabase","from","select","console","message","map","item","uid","name","sku","bulk","parseFloat","carton","parseInt","qty","sell","fetchSupplyLists","order","ascending","row","list_name","fetchSupplyListDetails","listName","eq","items","meta","_row$sell","_row$quantity","costEa","quantity","profit","metaData","metaError","limit","single","saveSupplyListItems","upsert","rows","filter","i","item_uid","isNaN","length","warn","onConflict","insert","editSupplyListItems","overwrite","saveSupplyListMeta","margin","shipping","shipping_rate","checkListNameExists","fetchSupplyListMeta","deleteSupplyList","itemError","delete","Items","setItems","useState","loading","setLoading","useEffect","then","updateItem","index","field","value","updated","_toConsumableArray","React","style","padding","fontFamily","border","cellPadding","cellSpacing","idx","key","onChange","e","target","type","toFixed"],"sourceRoot":""}